<!doctype html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Valentine Autofit</title>
    <style>
      * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
      
      body {
        font-family: "Segoe UI", Tahoma, sans-serif;
        background: linear-gradient(135deg, #ffeef8 0%, #ffd9ec 100%);
        height: 100vh;
        width: 100vw;
        display: flex;
        justify-content: center;
        align-items: center;
        overflow: hidden; /* Khóa cứng màn hình, không cho cuộn */
        padding: 5vmin;
      }

      .container {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        width: 100%;
        height: 100%;
      }

      .instruction {
        color: #ff1493;
        font-size: 4vmin; /* Chữ tự co giãn theo màn hình */
        font-weight: bold;
        margin-bottom: 3vmin;
        text-align: center;
        min-height: 5vmin;
      }

      /* CHIẾC PHONG BÌ THẦN THÁNH - TỰ CO GIÃN THEO VMIN */
      .envelope-wrapper {
        position: relative;
        width: 80vmin; /* Luôn chiếm 80% cạnh nhỏ nhất của màn hình */
        aspect-ratio: 550 / 350;
        perspective: 1000px;
      }

      .envelope-container {
        position: relative;
        width: 100%;
        height: 100%;
        cursor: pointer;
        transform-style: preserve-3d;
      }

      .envelope-base {
        position: absolute;
        inset: 0;
        background: #ff99cc;
        border-radius: 1.5vmin;
        box-shadow: 0 2vmin 5vmin rgba(0,0,0,0.1);
        z-index: 1;
      }

      .envelope-top-flap {
        position: absolute;
        top: -0.2vmin; left: 0; width: 100%; height: 52%;
        background: #ffcce0;
        clip-path: polygon(0 0, 100% 0, 50% 100%);
        transform-origin: top;
        transition: transform 0.6s ease-in-out, z-index 0.3s;
        z-index: 4;
      }
      .opened .envelope-top-flap { transform: rotateX(180deg); z-index: 0; }

      .envelope-front {
        position: absolute;
        inset: 0;
        z-index: 3;
        pointer-events: none;
      }
      .envelope-front::before {
        content: ""; position: absolute; inset: 0;
        background: #ffb3d9;
        clip-path: polygon(0 0, 50% 50%, 100% 0, 100% 100%, 0 100%);
      }
      .envelope-front::after {
        content: ""; position: absolute; inset: 0;
        background: #ffcce0;
        clip-path: polygon(0 100%, 50% 45%, 100% 100%);
      }

      .heart-seal {
        position: absolute;
        top: 50%; left: 50%; transform: translate(-50%, -40%);
        width: 10vmin; height: 10vmin;
        background: #ff1493;
        border-radius: 50%;
        z-index: 5;
        display: flex; align-items: center; justify-content: center;
        font-size: 5vmin;
        box-shadow: 0 1vmin 2vmin rgba(0,0,0,0.15);
        transition: 0.3s;
      }
      .opened .heart-seal { opacity: 0; visibility: hidden; }

      .letter {
        position: absolute;
        width: 92%; height: 85%;
        background: #fffef9;
        left: 4%; top: 7%;
        padding: 4vmin;
        border-radius: 1vmin;
        z-index: 2;
        transition: transform 0.7s cubic-bezier(0.4, 0, 0.2, 1);
        display: flex; flex-direction: column;
      }
      .letter.up { transform: translateY(-50%); z-index: 10; }

      .letter-content { opacity: 0; transition: 0.4s; }
      .opened .letter-content { opacity: 1; }
      .letter-content h2 { font-size: 3.5vmin; color: #ff1493; margin-bottom: 1.5vmin; }
      .letter-content p { font-size: 2.8vmin; line-height: 1.4; text-align: left; color: #333; }

      .signature { margin-top: auto; text-align: right; font-weight: bold; color: #ff1493; font-size: 2.5vmin; }

      .kitty {
        position: absolute;
        right: -5vmin; bottom: -8vmin;
        width: 15vmin; z-index: 20;
      }

      /* Photo Overlay */
      .photo-overlay {
        position: fixed; inset: 0;
        background: rgba(0,0,0,0.9);
        display: none; justify-content: center; align-items: center;
        z-index: 2000; padding: 5vmin;
      }
      .photo-frame { position: relative; max-width: 80vmin; background: white; padding: 2vmin; border-radius: 1vmin; }
      .photo-frame img { width: 100%; display: block; max-height: 70vh; object-fit: contain; }
      .close-btn { position: absolute; top: -7vmin; right: 0; color: white; font-size: 8vmin; cursor: pointer; }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="instruction" id="instruction">Bấm vào phong bì để mở nhé!</div>
      
      <div class="envelope-wrapper">
        <div class="envelope-container" id="envelopeContainer">
          <div class="envelope-base"></div>
          <div class="letter" id="letter">
            <div class="letter-content">
              <h2>Valentine Hạnh Phúc!</h2>
              <p>Mùa lễ tình nhân đã tới và anh thật may mắn khi có em ở bên cạnh. Em là món quà tuyệt vời nhất của anh. Chúc bé yêu luôn xinh đẹp và hạnh phúc!</p>
              <div class="signature">Gửi bé yêu của anh ❤️</div>
              <p style="font-size: 2vmin; color: #ff69b4; margin-top: 2vmin; text-align: center;">(Bấm vào thư để xem ảnh)</p>
            </div>
          </div>
          <div class="envelope-front"></div>
          <div class="envelope-top-flap"></div>
          <div class="heart-seal">❤️</div>
        </div>
        <img src="uploads/Hello Kitty Pink GIF.gif" class="kitty" alt="Kitty">
      </div>
    </div>

    <div class="photo-overlay" id="photoOverlay">
      <div class="photo-frame">
        <span class="close-btn" id="closePhoto">&times;</span>
        <img src="our-photo.jpg" alt="Our Photo">
        <p style="text-align: center; margin-top: 2vmin; color: #ff1493; font-weight: bold; font-size: 3vmin;">❤️ Chúng mình ❤️</p>
      </div>
    </div>

    <script>
      const container = document.getElementById("envelopeContainer");
      const letter = document.getElementById("letter");
      const photoOverlay = document.getElementById("photoOverlay");
      const closePhoto = document.getElementById("closePhoto");
      const instruction = document.getElementById("instruction");

      let state = "closed";

      container.addEventListener("click", () => {
        if (state === "closed") {
          container.classList.add("opened");
          instruction.innerText = "Rút thư ra nào...";
          state = "opened";
        } else if (state === "opened") {
          letter.classList.add("up");
          instruction.innerText = "Bấm vào thư để xem ảnh ❤️";
          state = "up";
        } else if (state === "up") {
          letter.classList.remove("up");
          container.classList.remove("opened");
          instruction.innerText = "Bấm để mở lại nhé!";
          state = "closed";
        }
      });

      letter.addEventListener("click", (e) => {
        if (state === "up") {
          e.stopPropagation();
          photoOverlay.style.display = "flex";
        }
      });

      closePhoto.addEventListener("click", () => {
        photoOverlay.style.display = "none";
      });
    </script>
  </body>
</html>
