<!doctype html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Valentine - Fixed & Responsive</title>
    <style>
      /* --- GIỮ NGUYÊN STYLE GỐC CỦA BẠN --- */
      * { margin: 0; padding: 0; box-sizing: border-box; }
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #ffeef8 0%, #ffe5f1 50%, #ffd9ec 100%);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 10px;
        overflow: hidden;
      }

      .container {
        text-align: center;
        width: 100%;
        max-width: 600px;
        position: relative;
        /* TỰ ĐỘNG SCALE ĐỂ VỪA MÀN HÌNH - KHÔNG BỊ TRÀN */
        transform: scale(clamp(0.4, 92vw / 545px, 1));
        transform-origin: center center;
      }

      .instruction {
        color: #ff1493;
        font-size: 26px;
        font-weight: bold;
        margin-bottom: 20px;
        text-shadow: 2px 2px 8px rgba(255, 105, 180, 0.3);
        height: 40px;
      }

      /* PHONG BÌ - GIỮ NGUYÊN TỶ LỆ GỐC */
      .envelope-wrapper {
        position: relative;
        width: 545px;
        height: 350px;
        margin: 0 auto;
        perspective: 1500px;
      }

      .envelope-container {
        position: relative;
        width: 100%;
        height: 100%;
        transform-style: preserve-3d;
        cursor: pointer;
      }

      .envelope-base {
        position: absolute;
        width: 100%;
        height: 100%;
        background: #ff99cc;
        box-shadow: 0 15px 35px rgba(255, 105, 180, 0.3);
        z-index: 1;
        border-radius: 4px;
      }

      /* THAY THẾ BORDER BẰNG SVG ĐỂ CHỐNG ĐẢO HÌNH */
      .envelope-svg {
        position: absolute;
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
        z-index: 3;
        pointer-events: none;
      }

      .envelope-top-flap {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        transform-origin: top;
        transition: transform 0.6s ease-in-out, z-index 0.2s;
        z-index: 4;
      }
      .opened .envelope-top-flap {
        transform: rotateX(180deg);
        z-index: 0;
      }

      /* LÁ THƯ - GIỮ NGUYÊN LOGIC CỦA BẠN */
      .letter {
        position: absolute;
        width: 90%;
        height: 90%;
        background: #fffef9;
        left: 5%;
        top: 25px;
        padding: 25px;
        border-radius: 5px;
        z-index: 2;
        transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
      }
      .letter.up { transform: translateY(-320px); z-index: 10; }

      .heart-seal {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 60px;
        height: 60px;
        background: #ff1493;
        border-radius: 50%;
        z-index: 5;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 30px;
        transition: 0.3s;
      }
      .opened .heart-seal { opacity: 0; transform: translate(-50%, -50%) scale(0); }

      /* HELLO KITTY - VỊ TRÍ CỐ ĐỊNH THEO PHONG BÌ */
      .gif-container {
        position: absolute;
        right: -120px;
        bottom: 0;
        z-index: 15;
      }
      .gif-container img { width: 140px; cursor: pointer; }

      /* TỜ GIẤY THỨ 2 & SLIDER - GIỮ NGUYÊN */
      .letter-two {
        position: absolute;
        width: 80%; height: 60%;
        background: #fff0f5; left: 10%; top: 20%;
        z-index: 100; display: none;
        flex-direction: column; justify-content: center; align-items: center;
        border: 2px dashed #ff69b4; border-radius: 10px;
      }
      .photo-overlay {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.9); display: none; z-index: 2000;
        justify-content: center; align-items: center;
      }
    </style>
  </head>
  <body>

    <div class="container">
      <div class="instruction" id="instruction">Bấm vào phong bì nhé!</div>

      <div class="envelope-wrapper">
        <div class="gif-container">
          <img src="uploads/Hello Kitty Pink GIF.gif" id="kittyGif" />
        </div>

        <div class="envelope-container" id="envelopeContainer">
          <div class="envelope-base"></div>

          <div class="letter" id="letter">
            <h2 style="color: #ff1493; margin-bottom: 12px;">Valentine Hạnh Phúc!</h2>
            <p style="text-align: left; font-size: 16px; line-height: 1.5; font-family: serif;">
              Mùa lễ tình nhân đã tới và anh thật may mắn khi có em ở bên cạnh...
            </p>
            <div id="triggerSlider" style="color: #ff69b4; margin-top: 15px; cursor: pointer; text-decoration: underline;">(Bấm xem bất ngờ)</div>
          </div>

          <div class="letter-two" id="letterTwo">
            <h2 style="color: #ff1493;">Yêu em nhiều!! ❤️</h2>
          </div>

          <svg class="envelope-svg" viewBox="0 0 545 350" preserveAspectRatio="none">
            <path d="M0 0 L272.5 175 L0 350 Z" fill="#ffcce0" /> <path d="M545 0 L272.5 175 L545 350 Z" fill="#ffcce0" /> <path d="M0 350 L545 350 L272.5 175 Z" fill="#ffb3d9" /> </svg>

          <div class="envelope-top-flap">
            <svg width="545" height="350" viewBox="0 0 545 350" preserveAspectRatio="none">
              <path d="M0 0 L545 0 L272.5 175 Z" fill="#ffcce0" />
            </svg>
          </div>

          <div class="heart-seal">❤️</div>
        </div>
      </div>
    </div>

    <div class="photo-overlay" id="photoOverlay" onclick="this.style.display='none'">
        <img src="our-photo.jpg" style="max-width: 90%; border-radius: 10px;">
    </div>

    <script>
      const container = document.getElementById("envelopeContainer");
      const letter = document.getElementById("letter");
      const letterTwo = document.getElementById("letterTwo");
      const instruction = document.getElementById("instruction");
      const kittyGif = document.getElementById("kittyGif");
      let currentState = "closed";

      // Chuyển đổi GIF
      kittyGif.onclick = function() {
        this.src = this.src.includes("Hello") ? "In Love Cat GIF.gif" : "uploads/Hello Kitty Pink GIF.gif";
      };

      container.addEventListener("click", function (e) {
        if (e.target.id === "triggerSlider") {
          document.getElementById("photoOverlay").style.display = "flex";
          return;
        }

        if (currentState === "closed") {
          this.classList.add("opened");
          instruction.innerText = "Bấm tiếp để rút thư ra...";
          currentState = "opened";
        } else if (currentState === "opened") {
          letter.classList.add("up");
          instruction.innerText = "Bấm ra ngoài để cất thư...";
          currentState = "up";
        } else if (currentState === "up" && !letter.contains(e.target)) {
          letter.classList.remove("up");
          setTimeout(() => {
            this.classList.remove("opened");
            letterTwo.style.display = "flex";
            currentState = "closed";
          }, 600);
        }
      });
    </script>
  </body>
</html>
