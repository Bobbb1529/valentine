<!doctype html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Phong Bì Valentine - Multi Media</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #ffeef8 0%, #ffe5f1 50%, #ffd9ec 100%);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        overflow: hidden;
      }
      
      /* --- LOGIC ÉP XOAY NGANG (FORCE LANDSCAPE) --- */
      .container {
        text-align: center;
        position: relative;
        transition: all 0.5s ease;
      }

      /* Khi người dùng cầm điện thoại dọc (Portrait) */
      @media screen and (orientation: portrait) {
        .container {
          /* Xoay toàn bộ nội dung 90 độ */
          transform: rotate(90deg) scale(clamp(0.1, 95vh / 600px, 0.8));
          width: 100vh; /* Chiều rộng lúc này là chiều cao màn hình */
          height: 100vw;
        }
      }

      /* Khi người dùng cầm điện thoại ngang (Landscape) */
      @media screen and (orientation: landscape) {
        .container {
          transform: scale(clamp(0.1, 85vh / 450px, 0.75));
          width: 100%;
          max-width: 800px;
        }
        .letter.up {
          transform: translateY(-280px) !important;
        }
      }

      /* --- GIỮ NGUYÊN CÁC THUỘC TÍNH CŨ CỦA BẠN --- */
      .instruction {
        color: #ff1493;
        font-size: 24px;
        font-weight: bold;
        margin-bottom: 20px;
        animation: floatText 3s ease-in-out infinite;
      }
      @keyframes floatText {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-10px); }
      }

      .envelope-wrapper {
        position: relative;
        width: 545px;
        height: 350px;
        margin: 50px auto;
        perspective: 1500px;
      }
      .envelope-container {
        position: relative;
        width: 100%;
        height: 100%;
        transform-style: preserve-3d;
        cursor: pointer;
      }
      .envelope-base {
        position: absolute;
        width: 100%; height: 100%;
        background: #ff99cc;
        box-shadow: 0 15px 35px rgba(255, 105, 180, 0.3);
        z-index: 1;
      }
      .envelope-top-flap {
        position: absolute;
        top: 0; left: 0; width: 0; height: 0;
        border-style: solid;
        border-width: 180px 272.5px 0 272.5px;
        border-color: #ffcce0 transparent transparent transparent;
        transform-origin: top;
        transition: transform 0.6s ease-in-out, z-index 0.2s;
        z-index: 4;
      }
      .opened .envelope-top-flap { transform: rotateX(180deg); z-index: 0; }
      
      .envelope-front {
        position: absolute;
        width: 100%; height: 100%;
        z-index: 3; pointer-events: none;
      }
      .envelope-front::before {
        content: ""; position: absolute; bottom: 0; left: 0;
        border-style: solid; border-width: 0 0 175px 545px;
        border-color: transparent transparent #ffb3d9 transparent;
      }
      .envelope-front::after {
        content: ""; position: absolute; bottom: 0; left: 0;
        border-style: solid; border-width: 175px 272.5px 175px 272.5px;
        border-color: transparent #ffcce0 #ffcce0 #ffcce0;
      }

      .heart-seal {
        position: absolute; top: 50%; left: 50%;
        transform: translate(-50%, -50%);
        width: 60px; height: 60px; background: #ff1493;
        border-radius: 50%; z-index: 5;
        display: flex; align-items: center; justify-content: center;
        font-size: 30px; transition: 0.3s;
      }
      .opened .heart-seal { opacity: 0; transform: translate(-50%, -50%) scale(0); }

      .letter {
        position: absolute; width: 90%; height: 90%;
        background: #fffef9; left: 5%; top: 25px;
        padding: 30px; border-radius: 5px; z-index: 2;
        transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
      }
      .letter.up { transform: translateY(-350px); z-index: 10; }

      .gif-container {
        position: absolute; right: -150px; top: 50%;
        transform: translateY(-50%);
      }
      .gif-container img { width: 150px; border-radius: 15px; }

      /* TỜ GIẤY THỨ 2 */
      .letter-two {
        position: absolute; width: 80%; height: 60%;
        background: #fff0f5; left: 10%; top: 20%;
        padding: 20px; border-radius: 10px; z-index: 100;
        display: none; flex-direction: column;
        justify-content: center; align-items: center;
        border: 2px dashed #ff69b4;
      }
    </style>
  </head>

  <body>
    <div class="container">
      <div class="instruction" id="instruction">Bấm vào phong bì để mở nhé!</div>
      <div class="envelope-wrapper">
        <div class="gif-container">
          <img src="uploads/Hello Kitty Pink GIF.gif" id="kittyGif" />
        </div>
        <div class="envelope-container" id="envelopeContainer">
          <div class="envelope-base"></div>
          <div class="letter" id="letter">
            <div class="letter-content">
              <h2 style="color: #ff1493; margin-bottom: 12px;">Valentine Hạnh Phúc!</h2>
              <p style="font-size: 16px; text-align: left;">
                Mùa lễ tình nhân đã tới và anh thật may mắn khi có em ở bên cạnh...
              </p>
              <div id="triggerSlider" style="color: #ff69b4; margin-top: 20px; cursor: pointer; text-decoration: underline;">
                (Xem bất ngờ)
              </div>
            </div>
          </div>
          <div class="letter-two" id="letterTwo">
            <h2 style="color: #ff1493;">Yêu em nhiều!! ❤️</h2>
          </div>
          <div class="envelope-front"></div>
          <div class="envelope-top-flap"></div>
          <div class="heart-seal">❤️</div>
        </div>
      </div>
    </div>

    <script>
      // Giữ nguyên logic JavaScript cũ của bạn
      const container = document.getElementById("envelopeContainer");
      const letter = document.getElementById("letter");
      const instruction = document.getElementById("instruction");
      const letterTwo = document.getElementById("letterTwo");
      let currentState = "closed";

      container.addEventListener("click", function () {
        if (currentState === "closed") {
          container.classList.add("opened");
          instruction.innerText = "Bấm tiếp để rút thư...";
          currentState = "opened";
        } else if (currentState === "opened") {
          letter.classList.add("up");
          instruction.innerText = "Bấm ra ngoài để cất thư ❤️";
          currentState = "up";
        }
      });

      // Thêm logic cất thư khi bấm ra ngoài
      document.addEventListener("click", function(e) {
        if (currentState === "up" && !container.contains(e.target)) {
            letter.classList.remove("up");
            container.classList.remove("opened");
            letterTwo.style.display = "flex";
            currentState = "closed";
        }
      }, true);
    </script>
  </body>
</html>
