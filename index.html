<!doctype html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Phong Bì Valentine - Multi Media</title>
    <style>
      /* --- TỐI ƯU HÓA TOÀN DIỆN --- */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        -webkit-tap-highlight-color: transparent; /* Xóa khung xanh khi click trên mobile */
      }
      
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #ffeef8 0%, #ffe5f1 50%, #ffd9ec 100%);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        overflow: hidden; /* Chống cuộn lung tung trên mobile */
        touch-action: manipulation;
      }

      .container {
        text-align: center;
        width: 100%;
        max-width: 100vw;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 10px;
      }

      .instruction {
        color: #ff1493;
        font-size: clamp(16px, 4vw, 24px);
        font-weight: bold;
        margin-bottom: 10px;
        text-shadow: 1px 1px 4px rgba(255, 105, 180, 0.3);
        animation: floatText 3s ease-in-out infinite;
        z-index: 100;
        pointer-events: none;
      }

      @keyframes floatText {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-5px); }
      }

      /* PHONG BÌ - SỬ DỤNG SCALE ĐỂ VỪA KHÍT MỌI MÀN HÌNH */
      .envelope-wrapper {
        position: relative;
        /* Kích thước gốc của phong bì */
        width: 545px;
        height: 350px;
        perspective: 1500px;
        /* Tự động thu nhỏ nếu màn hình bé hơn 545px */
        transform-origin: center center;
      }

      /* Responsive cho mobile cực nhỏ hoặc xoay ngang */
      @media (max-width: 600px) {
        .envelope-wrapper {
          transform: scale(0.6); /* Thu nhỏ 60% trên phone dọc */
        }
      }
      @media (max-width: 400px) {
        .envelope-wrapper {
          transform: scale(0.5); /* Thu nhỏ 50% trên phone bé */
        }
      }
      @media (max-height: 500px) {
        .envelope-wrapper {
          transform: scale(0.5); /* Thu nhỏ khi xoay ngang mà màn hình thấp */
        }
      }

      .envelope-container {
        position: relative;
        width: 100%;
        height: 100%;
        transform-style: preserve-3d;
        cursor: pointer;
      }

      .envelope-base {
        position: absolute;
        width: 100%;
        height: 100%;
        background: #ff99cc;
        box-shadow: 0 15px 35px rgba(255, 105, 180, 0.3);
        z-index: 1;
      }

      .envelope-top-flap {
        position: absolute;
        top: 0;
        left: 0;
        width: 0;
        height: 0;
        border-style: solid;
        border-width: 180px 272.5px 0 272.5px;
        border-color: #ffcce0 transparent transparent transparent;
        transform-origin: top;
        transition: transform 0.6s ease-in-out, z-index 0.2s;
        z-index: 4;
      }

      .opened .envelope-top-flap {
        transform: rotateX(180deg);
        z-index: 0;
      }

      .envelope-front {
        position: absolute;
        width: 100%;
        height: 100%;
        z-index: 3;
        pointer-events: none;
      }
      .envelope-front::before {
        content: "";
        position: absolute;
        bottom: 0;
        left: 0;
        border-style: solid;
        border-width: 0 0 175px 545px;
        border-color: transparent transparent #ffb3d9 transparent;
      }
      .envelope-front::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 0;
        border-style: solid;
        border-width: 175px 272.5px 175px 272.5px;
        border-color: transparent #ffcce0 #ffcce0 #ffcce0;
      }

      .heart-seal {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(1);
        width: 60px;
        height: 60px;
        background: #ff1493;
        border-radius: 50%;
        z-index: 5;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 30px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        transition: opacity 0.3s ease, transform 0.3s ease;
      }

      .opened .heart-seal {
        opacity: 0;
        transform: translate(-50%, -50%) scale(0);
      }

      /* TỜ GIẤY */
      .letter {
        position: absolute;
        width: 90%;
        height: 90%;
        background: #fffef9;
        left: 5%;
        top: 20px;
        padding: 25px;
        border-radius: 5px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        z-index: 2;
        transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1), z-index 0.1s;
        overflow-y: auto; /* Cho phép cuộn nội dung thư nếu quá dài */
      }
      .letter.up {
        transform: translateY(-280px);
        z-index: 10;
      }

      /* GIF TRANG TRÍ - ĐƯA VÀO TRONG CONTAINER ĐỂ ĐI THEO PHONG BÌ */
      .gif-container {
        position: absolute;
        right: -120px;
        bottom: 0;
        z-index: 20;
      }
      .gif-container img {
        width: 120px;
        border-radius: 15px;
      }

      @media (max-width: 600px) {
        .gif-container {
            right: 0;
            bottom: -100px; /* Đưa xuống dưới khi màn hình hẹp */
        }
      }

      /* SLIDER - ĐẢM BẢO FULL MÀN HÌNH */
      .photo-overlay {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.95);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 9999;
      }
      .slider-container {
        position: relative;
        width: 95%;
        max-width: 500px;
        background: white;
        border-radius: 15px;
        padding: 10px;
      }
      .slider-track {
        display: flex;
        transition: transform 0.5s ease-in-out;
      }
      .slide-item {
        min-width: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      .slide-item img {
        width: 100%;
        max-height: 60vh;
        object-fit: contain;
        border-radius: 10px;
      }

      .nav-btn {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        background: #ff1493;
        color: white;
        border: none;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        font-size: 20px;
        z-index: 10;
      }
      .prev-btn { left: -20px; }
      .next-btn { right: -20px; }
      .close-photo {
        position: absolute;
        top: -40px;
        right: 0;
        color: white;
        font-size: 35px;
        cursor: pointer;
      }
    </style>
  </head>

  <body>
    <div class="container">
      <div class="instruction" id="instruction">
        Chạm vào phong bì để mở nhé!
      </div>

      <div class="envelope-wrapper">
        <div class="gif-container">
          <img src="uploads/Hello Kitty Pink GIF.gif" alt="Kitty" id="kittyGif" />
        </div>

        <div class="envelope-container" id="envelopeContainer">
          <div class="envelope-base"></div>

          <div class="letter" id="letter">
            <div class="letter-content">
              <h2 style="color: #ff1493; margin-bottom: 10px;">Valentine Hạnh Phúc!</h2>
              <p style="color: #333; line-height: 1.4; text-align: left; font-size: 15px;">
                Mùa lễ tình nhân đã tới và anh thật may mắn khi có em ở bên cạnh.
                Cảm ơn em và chúc em có ngày Valentine thật tuyệt vời!
              </p>
              <div style="text-align: right; color: #ff1493; font-weight: bold; margin-top: 10px;">Yêu em❤️</div>
              
              <div id="triggerSlider" style="margin-top: 20px; color: #ff69b4; text-decoration: underline; font-weight: bold; cursor: pointer;">
                (Bấm vào đây xem bất ngờ)
              </div>
            </div>
          </div>

          <div class="envelope-front"></div>
          <div class="envelope-top-flap"></div>
          <div class="heart-seal">❤️</div>
        </div>
      </div>
    </div>

    <div class="photo-overlay" id="photoOverlay">
      <div class="slider-container">
        <span class="close-photo" id="closePhoto">&times;</span>
        <button class="nav-btn prev-btn" id="prevBtn">&#10094;</button>
        <button class="nav-btn next-btn" id="nextBtn">&#10095;</button>
        <div class="slider-track" id="sliderTrack">
          <div class="slide-item">
            <img src="our-photo.jpg" alt="Photo 1" />
            <p>Kỷ niệm 1❤️</p>
          </div>
          <div class="slide-item">
            <img src="hp1.jpg" alt="Photo 2" />
            <p>Hải Phòng❤️</p>
          </div>
        </div>
      </div>
    </div>

    <script>
      const container = document.getElementById("envelopeContainer");
      const letter = document.getElementById("letter");
      const instruction = document.getElementById("instruction");
      const photoOverlay = document.getElementById("photoOverlay");
      const triggerSlider = document.getElementById("triggerSlider");
      const track = document.getElementById("sliderTrack");
      
      let currentState = "closed";

      // Xử lý mở thư
      container.addEventListener("click", function (e) {
        if (e.target.id === "triggerSlider") return; // Tránh xung đột link

        if (currentState === "closed") {
          container.classList.add("opened");
          instruction.innerText = "Chạm lần nữa để rút thư...";
          currentState = "opened";
        } else if (currentState === "opened") {
          letter.classList.add("up");
          instruction.innerText = "Xem nội dung thư nhé ❤️";
          currentState = "up";
        } else if (currentState === "up" && !letter.contains(e.target)) {
            // Cất thư nếu bấm ra ngoài khi thư đang mở
            letter.classList.remove("up");
            setTimeout(() => {
                container.classList.remove("opened");
                currentState = "closed";
                instruction.innerText = "Chạm để mở lại!";
            }, 500);
        }
      });

      // Mở Slider
      triggerSlider.addEventListener("click", (e) => {
        e.stopPropagation();
        photoOverlay.style.display = "flex";
      });

      document.getElementById("closePhoto").addEventListener("click", () => {
        photoOverlay.style.display = "none";
      });

      // Logic Slider đơn giản
      let index = 0;
      const slides = document.querySelectorAll(".slide-item");
      document.getElementById("nextBtn").addEventListener("click", () => {
        index = (index + 1) % slides.length;
        track.style.transform = `translateX(-${index * 100}%)`;
      });
      document.getElementById("prevBtn").addEventListener("click", () => {
        index = (index - 1 + slides.length) % slides.length;
        track.style.transform = `translateX(-${index * 100}%)`;
      });

      // Đổi GIF khi bấm
      const kittyGif = document.getElementById("kittyGif");
      kittyGif.addEventListener("click", function() {
          this.src = this.src.includes("Hello") ? "In Love Cat GIF.gif" : "uploads/Hello Kitty Pink GIF.gif";
      });
    </script>
  </body>
</html>

