<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Phong Bì Valentine - Fixed</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: "Segoe UI", sans-serif;
            background: linear-gradient(135deg, #ffeef8 0%, #ffd9ec 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            padding: 20px;
        }

        .container {
            text-align: center;
            width: 100%;
            max-width: 550px;
            position: relative;
        }

        .instruction {
            color: #ff1493;
            font-size: clamp(16px, 5vw, 22px);
            font-weight: bold;
            margin-bottom: 20px;
            text-shadow: 1px 1px 5px rgba(255, 105, 180, 0.2);
        }

        /* KHUNG PHONG BÌ */
        .envelope-wrapper {
            position: relative;
            width: 100%;
            aspect-ratio: 545 / 350;
            perspective: 1000px;
            margin: 0 auto;
        }

        .envelope-container {
            position: relative;
            width: 100%;
            height: 100%;
            cursor: pointer;
            transform-style: preserve-3d;
        }

        /* SVG LÀM NỀN PHONG BÌ */
        .envelope-svg {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            display: block;
        }

        .base-rect { fill: #ff99cc; }
        .front-left-right { fill: #ffcce0; }
        .front-bottom { fill: #ffb3d9; }
        .top-flap-color { fill: #ffd9ec; stroke: #ffb3d9; stroke-width: 1; }

        /* NẮP PHONG BÌ */
        .top-flap {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 50%;
            transform-origin: top;
            transition: transform 0.6s ease-in-out;
            z-index: 4;
        }

        .opened .top-flap {
            transform: rotateX(180deg);
            z-index: 1;
        }

        /* TỜ THƯ */
        .letter {
            position: absolute;
            width: 90%;
            height: 85%;
            background: #fffef9;
            left: 5%;
            top: 5%;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 2;
            transition: transform 0.7s ease-in-out;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .letter.up {
            transform: translateY(-80%);
            z-index: 10;
        }

        .letter-content { opacity: 0; transition: 0.3s; }
        .opened .letter-content { opacity: 1; }
        .letter-content h2 { color: #ff1493; font-size: 1.2rem; margin-bottom: 10px; }
        .letter-content p { font-size: 0.9rem; line-height: 1.5; color: #333; }

        .heart-seal {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 50px;
            height: 50px;
            background: #ff1493;
            border-radius: 50%;
            z-index: 5;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            transition: 0.3s;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        .opened .heart-seal { opacity: 0; pointer-events: none; }

        /* KITTY GIF */
        .kitty {
            position: absolute;
            right: -50px;
            bottom: 0;
            width: 80px;
            z-index: 20;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="instruction" id="instruction">Bấm vào phong bì để mở nhé!</div>
    
    <div class="envelope-wrapper">
        <img src="uploads/Hello Kitty Pink GIF.gif" class="kitty" id="kittyGif">

        <div class="envelope-container" id="envelopeContainer">
            <svg class="envelope-svg" viewBox="0 0 545 350">
                <rect class="base-rect" width="545" height="350" />
            </svg>

            <div class="letter" id="letter">
                <div class="letter-content">
                    <h2>Valentine Hạnh Phúc! ❤️</h2>
                    <p>Mùa lễ tình nhân đã tới và anh thật may mắn khi có em ở bên cạnh. Chúc em một ngày thật tuyệt vời!</p>
                    <p style="margin-top:10px; font-weight:bold; color:#ff1493; cursor:pointer; text-decoration:underline;" id="triggerSlider">
                        (Bấm để xem bất ngờ)
                    </p>
                </div>
            </div>

            <svg class="envelope-svg" style="z-index: 3; pointer-events: none;" viewBox="0 0 545 350">
                <path class="front-left-right" d="M0 0 L272.5 175 L0 350 Z" />
                <path class="front-left-right" d="M545 0 L272.5 175 L545 350 Z" />
                <path class="front-bottom" d="M0 350 L545 350 L272.5 175 Z" />
            </svg>

            <div class="top-flap">
                <svg width="100%" height="100%" viewBox="0 0 545 175" preserveAspectRatio="none">
                    <path class="top-flap-color" d="M0 0 L545 0 L272.5 175 Z" />
                </svg>
            </div>

            <div class="heart-seal">❤️</div>
        </div>
    </div>
</div>

<script>
    const container = document.getElementById("envelopeContainer");
    const letter = document.getElementById("letter");
    const instruction = document.getElementById("instruction");
    let step = 0;

    container.addEventListener("click", function(e) {
        if(e.target.id === "triggerSlider") return;

        if (step === 0) {
            this.classList.add("opened");
            instruction.innerText = "Bấm tiếp để rút thư...";
            step = 1;
        } else if (step === 1) {
            letter.classList.add("up");
            instruction.innerText = "Yêu em nhiều! ❤️";
            step = 2;
        } else {
            letter.classList.remove("up");
            this.classList.remove("opened");
            instruction.innerText = "Bấm để mở lại nhé!";
            step = 0;
        }
    });

    document.getElementById("triggerSlider").addEventListener("click", (e) => {
        e.stopPropagation();
        alert("Chức năng xem ảnh đang được mở..."); // Bạn có thể thêm modal ảnh của mình vào đây
    });
</script>

</body>
</html>
